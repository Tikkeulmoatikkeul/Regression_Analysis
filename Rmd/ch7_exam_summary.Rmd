---
title: "ch7_exam_summary"
author: "doellomdoel"
date: "2024-06-10"
output: html_document
---

```{r setup, include=FALSE}
# R code ì¶œë ¥, warning ì¶œë ¥X, íŒ¨í‚¤ì§€ ë¡œë“œ ë©”ì„¸ì§€ ì¶œë ¥X

knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## 0. ë°ì´í„° ë¡œë“œ bodyfat
```{r}
bodyfat<-read.table(
  "https://users.stat.ufl.edu/~rrandles/sta4210/Rclassnotes/data/textdatasets/KutnerData/Chapter%20%207%20Data%20Sets/CH07TA01.txt")

# ì»¬ëŸ¼ ì§€ì •
names(bodyfat)<-c("X1","X2","X3","Y")

# ë°ì´í„° í™•ì¸
# ì¼ë¶€
head(bodyfat)
tail(bodyfat)

# ì°¨ì›
dim(bodyfat)

# ìš”ì•½
summary(bodyfat)
```

## 1. ì‹œê°í™” pairs, pairs2
```{r}
# ì‹œê°í™”
pairs(bodyfat)
```
```{r}
library(ggplot2)
library(GGally)
ggpairs(bodyfat)
```

## 2. ì„ í˜• íšŒê·€ ëª¨ë¸ ì¶”ì •
#### 2-1. íšŒê·€ ê³„ìˆ˜(bhat) ê³„ì‚°
```{r}
Y<-bodyfat$Y
X<-cbind(1,bodyfat$X1, bodyfat$X2, bodyfat$X3)
bhat<-solve(t(X)%*%X)%*%t(X)%*%Y
bhat
```

#### 2-2. lm í•¨ìˆ˜ë¡œ íšŒê·€ ëª¨ë¸ ì¶”ì •
##### 2-2-1. Y~X1
```{r}
lm1<-lm(Y~X1, data=bodyfat)
coef(summary(lm1))
anova(lm1)
```
##### 2-2-2. Y~X2
```{r}
lm2<-lm(Y~X2, data=bodyfat)
coef(summary(lm2))
anova(lm2)
```
##### 2-2-3. Y~X1+X2
```{r}
lm3<-lm(Y~X1+X2, data=bodyfat)
coef(summary(lm3))
anova(lm3)
```
##### 2-2-4. Y~X1+X2+X3
```{r}
lm4<-lm(Y~X1+X2+X3, data=bodyfat)
coef(summary(lm4))
anova(lm4)
```

## 3. ì„ í˜• íšŒê·€ ëª¨ë¸ ë¹„êµ

#### 3-1. lm3 vs lm4
```{r}

anova(lm3, lm4)

```
- p-valueëŠ” 0.1896ì…ë‹ˆë‹¤. ì´ ê°’ì€ F í†µê³„ëŸ‰ì— ëŒ€í•œ p-valueë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ê¸° ë•Œë¬¸ì— X3ì„ ì¶”ê°€í•˜ì—¬ ëª¨ë¸ì´ í–¥ìƒë˜ì—ˆë‹¤ê³  ë§í•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ X3ì„ ì¶”ê°€í•˜ì—¬ ëª¨ë¸ì„ ê°œì„ í•˜ëŠ” ê²ƒì€ ìœ ì˜í•˜ì§€ ì•Šë‹¤


#### 3-2. lm1 vs lm4
```{r}

anova(lm1, lm4)

```
- F í†µê³„ëŸ‰ì˜ p-ê°’ì´ 0.04995ë¡œ, ì´ëŠ” ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì— *ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ë”°ë¼ì„œ ëª¨ë¸ 2ê°€ ëª¨ë¸ 1ë³´ë‹¤ ì¢…ì† ë³€ìˆ˜ Yë¥¼ ì„¤ëª…í•˜ëŠ” ë° í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ê²Œ ë” ì í•©í•˜ë‹¤ëŠ” ê²ƒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
- ì¦‰, X2ì™€ X3ì„ ì¶”ê°€í•œ ëª¨ë¸ 2ê°€ X1ë§Œì„ í¬í•¨í•œ ëª¨ë¸ 1ë³´ë‹¤ Yë¥¼ ì„¤ëª…í•˜ëŠ” ë° ë” ë‚˜ì€ ëª¨ë¸ì…ë‹ˆë‹¤.



## 4. í•©ì„± ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•œ ëª¨ë¸ ë¹„êµ
#### 4-1. X12 = X1+X2

```{r}
bodyfat$X12<-bodyfat$X1+bodyfat$X2

lm5<-lm(Y~X12+X3, data=bodyfat)

anova(lm5, lm4)
```

#### 4-2. GLH ê²€ì •
```{r}
library(gmodels)
glh.test(lm4, cm=c(0, 1, -1, 0))
```
- p-ê°’ì´ 0.2171ë¡œ ìœ ì˜ìˆ˜ì¤€ì¸ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ, X1ê³¼ X2ë¥¼ ê°œë³„ì ìœ¼ë¡œ ì¶”ê°€í•˜ëŠ” ê²ƒì´ X12ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ ëª¨ë¸ì„ ê°œì„ í•˜ëŠ” ë°ì—ëŠ” í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ì—†ë‹¤ëŠ” ê²ƒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

- lm4 ëª¨ë¸ì—ì„œ X1ê³¼ X2ì˜ íšŒê·€ ê³„ìˆ˜ê°€ ë™ì¼í•œì§€ ê²€ì •í•˜ëŠ” ì¼ë°˜ ì„ í˜• ê°€ì„¤ ê²€ì • (GLH í…ŒìŠ¤íŠ¸)ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
- p-ê°’ì´ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ, ê·€ë¬´ê°€ì„¤ 
H0(ì¦‰,ğ›½1âˆ’ğ›½2 = 0)ì„ ê¸°ê°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
- ì´ëŠ” X1ê³¼ X2ì˜ íšŒê·€ ê³„ìˆ˜ê°€ ìœ ì˜ë¯¸í•˜ê²Œ ë‹¤ë¥´ì§€ ì•Šë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.


## 5. íšŒê·€ ê³„ìˆ˜ë¥¼ ê³„ì‚°í•˜ëŠ” 3ê°€ì§€ ë°©ë²•
#### 5-1. ì¼ë°˜ ì„ í˜• íšŒê·€(Ordinary Linear Regression)

- ìµœì†Œì œê³±ë²•(OLS)ì„ ì‚¬ìš©í•˜ì—¬ íšŒê·€ê³„ìˆ˜ë¥¼ ì¶”ì •
- ì ˆí¸ í¬í•¨ ê°€ëŠ¥
- ë°ì´í„° ë‹¨ìœ„ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- ê°€ì¥ ì§ê´€ì ì´ë‚˜ ë‹¤ì¤‘ê³µì„ ì„±ì— ë¯¼ê°í•˜ê³  ë³€ìˆ˜ ë‹¨ìœ„ê°€ ë‹¤ë¥´ë©´ ê³„ìˆ˜ ë¹„êµ ì–´ë ¤ì›€
```{r}
lm.bodyfat <- lm(Y~X1+X2, data=bodyfat)
lm.bodyfat
```

#### 5-2. í‘œì¤€í™” íšŒê·€(Standardized regression)
- Yì™€ Xë¥¼ ëª¨ë‘ í‘œì¤€í™”(z-score)
- ì ˆí¸ ì œê±° (0 +)
- ë‹¨ìœ„ì— ìƒê´€ì—†ì´ ë³€ìˆ˜ ì˜í–¥ë ¥ ë¹„êµ ê°€ëŠ¥
- ë³€ìˆ˜ ê°„ ì˜í–¥ë ¥ ë¹„êµ ê°€ëŠ¥í•˜ë‚˜ ì ˆí¸ ì •ë³´ê°€ ì†ì‹¤ë˜ì–´ ì‹¤ì œ ê°’ ë‹¨ìœ„ë¡œ í•´ì„ ë¶ˆê°€
```{r}
lm(scale(Y)~0+scale(X1)+scale(X2), data=bodyfat)
```

#### 5-3. ìƒê´€í–‰ë ¬ ì´ìš© ê³„ì‚°(Correlation Matrix Method)
- Xì˜ ìƒê´€í–‰ë ¬ê³¼ Y-X ìƒê´€í–‰ë ¬ ì´ìš©
- ìˆ˜í•™ì ìœ¼ë¡œ ê³„ìˆ˜ ì‚°ì¶œ ê³¼ì •ì´ ëª…í™•ì´ ë“œëŸ¬ë‚˜ê³ , ì ì€ ë³€ìˆ˜ì—ì„œ ì§ê´€ì ì´ë‚˜ ë³€ìˆ˜ ê°œìˆ˜ê°€ ë§ìœ¼ë©´ ê³„ì‚°ì´ ì–´ë µê³  ì ˆí¸ í¬í•¨ ì‹œ ë³„ë„ ì²˜ë¦¬ê°€ í•„ìš”
```{r}
# step1) X1ê³¼ X2ì˜ ìƒê´€í–‰ë ¬ Rxx
Rxx<-cor(cbind(bodyfat$X1, bodyfat$X2))

# step2) Yì™€ X1,X2ì˜ ìƒê´€í–‰ë ¬ Ryx
Ryx<-rbind(cor(bodyfat$Y, bodyfat$X1), cor(bodyfat$Y, bodyfat$X2))

# step3) Rxx-1*Ryxë¥¼ í–‰ë ¬ ì—°ì‚°
solve(Rxx)%*%Ryx
```

## The End
